(this["webpackJsonpmelody-world-client"]=this["webpackJsonpmelody-world-client"]||[]).push([[15],{635:function(e,t,a){},694:function(e,t,a){"use strict";a.r(t);var n=a(259),r=a(0),c=a.n(r),o=a(634),s=a.n(o),i=a(174),l=a(70),u=a(703),d=a(635),m=a.n(d);function p(e,t,a,n,r){var c=function(e,t){for(var a=e.split(","),n=a[0].match(/:(.*?);/)[1],r=atob(a[1]),c=r.length,o=new Uint8Array(c);c--;)o[c]=r.charCodeAt(c);return new Blob([o],{type:n})}(t);e.multipartUpload(a,c,{mime:"image/jpg"}).then((function(e){n&&n(e)})).catch((function(e){r&&r(e)}))}var f=a(33);var g=function(e){var t="image/jpeg"===e.type||"image/png"===e.type;t||i.a.error("You can only upload JPG/PNG file!");var a=e.size/1024/1024<2;return a||i.a.error("Image must smaller than 2MB!"),t&&a};t.default=function(e){var t=Object(r.useState)(!1),a=Object(n.a)(t,2),o=a[0],i=a[1],d=Object(r.useState)(""),y=Object(n.a)(d,2),h=y[0],v=y[1],b="",w=Object(r.useMemo)((function(){return c.a.createElement("div",null,c.a.createElement(l.a,{type:o?"loading":"plus"}),c.a.createElement("div",{className:"ant-upload-text"},"Upload"))}),[o]);return c.a.createElement(u.a,{name:"avatar",listType:"picture-card",className:m.a.upload,showUploadList:!1,beforeUpload:g,onChange:function(t){"uploading"!==t.file.status?"done"===t.file.status&&function(e,t){var a=new FileReader;a.addEventListener("load",(function(){return t(a.result)})),a.readAsDataURL(e)}(t.file.originFileObj,(function(a){Object(f.a)("/ossSts").then((function(n){p(new s.a({region:"oss-cn-beijing",accessKeyId:n.AccessKeyId,accessKeySecret:n.AccessKeySecret,bucket:"melodyworld",stsToken:n.SecurityToken}),a,"headers/".concat(Date.now(),"_").concat(t.file.name),(function(t){if(200===t.res.statusCode){var a=t.res.requestUrls[0]+"?x-oss-process=style/_90_90";b=t.name,i(!1),v(a),e.updateImgDate({headerImgUrl:a,headerImgName:b},b)}}))}))})):i(!0)}},h?c.a.createElement("img",{src:h,alt:"avatar",style:{width:"100%"}}):w)}}}]);
//# sourceMappingURL=15.c6bbeaf9.chunk.js.map